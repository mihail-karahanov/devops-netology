# devops-netology

## 3.3. Операционные системы, лекция 1 - Михаил Караханов

**1. Какой системный вызов делает команда `cd`? ...**
- Ответ: выполнил команду `strace /bin/bash -c 'cd /tmp' 2>&1`. Команда `cd` выполняет системный вызов `chdir()`. Результат: \
`chdir("/tmp")`

**2. Попробуйте использовать команду `file` на объекты разных типов на файловой системе. ... Используя `strace` выясните, где находится база данных `file` на основании которой она делает свои догадки.**
- Ответ: выполнил команду `strace file /dev/sda 2>&1`. Изучив вывод, нашел следующий системный вызов: `openat(AT_FDCWD, "/usr/share/misc/magic.mgc", O_RDONLY) = 3`, открытие файла `magic.mgc`, который является симлинком на файл `/usr/lib/file/magic.mgc`. В данном файле хранится информация по основным типам файлов в операционной системе (на основании их "magic number").

**3. Предположим, приложение пишет лог в текстовый файл. Этот файл оказался удален (deleted в lsof), однако возможности сигналом сказать приложению переоткрыть файлы или просто перезапустить приложение – нет. Так как приложение продолжает писать в удаленный файл, место на диске постепенно заканчивается. Основываясь на знаниях о перенаправлении потоков предложите способ обнуления открытого удаленного файла (чтобы освободить место на файловой системе).**
- Ответ: зная PID приложения, можно с помощью команды `lsof -p <PID>` узнать имя удаленного файла и номер его файлового дескриптора. Далее, можно пустить поток этого файлового дескриптора на вход программе `cat`, а вывод этой команды отправить в `/dev/null` - `cat /proc/<PID>/fd/<descr_number> > /dev/null`.

**4. Занимают ли зомби-процессы какие-то ресурсы в ОС (CPU, RAM, IO)?**
- Ответ: нет, только строчку в таблице процессов.
  
**5. В iovisor BCC есть утилита `opensnoop` ... На какие файлы вы увидели вызовы группы open за первую секунду работы утилиты?**
- Ответ: воспользовался утилитой `opensnoop-bpfcc` c флагом `-d` (duration, время выполнения). Результат: \
![opensnoop example](./opensnoop.png)